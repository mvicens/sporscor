(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();const Ss=`<nav class="navbar bg-body-tertiary mb-3">\r
	<div class="container-fluid">\r
		<span class="navbar-brand h1 mb-0">SporScor</span>\r
		<form class="d-flex">\r
			<select class="form-select"></select>\r
		</form>\r
	</div>\r
</nav>\r
<div class="container-fluid">\r
	<div class="row">\r
		<div class="col">\r
			<aside class="mb-3">\r
				<div id="panel"></div>\r
			</aside>\r
		</div>\r
		<div class="col-md-9">\r
			<main>\r
				<div id="scoreboard" class="mb-3"></div>\r
				<div id="stats"></div>\r
			</main>\r
		</div>\r
	</div>\r
</div>`,Ue="N/A",N="",ws={content:"content",disadvantaged:"disadvantaged",hidden:"hidden",highlight:"highlight",invisible:"invisible",isInTieBreak:"is-in-tie-break",labelLeft:"label-left",labelRight:"label-right",lowlight:"lowlight",panel:"panel",root:"root",scoreboard:"scoreboard",serve:"serve",stats:"stats"};function R(t){if(!A(t))throw new Z(`Expected a defined value, but received: ${t}`)}function Y(t){if(!Ie(t))throw new Z(`Expected a number, but received: ${t}`)}function Os(t){if(!Fe(t))throw new Z(`Expected an array, but received: ${t}`)}const M=t=>t.charAt(0).toUpperCase()+t.slice(1);function Ve(t){return(e,s)=>{e=M(e),A(s)&&(e="%c"+e);const i=console[t];q(s)?i(e):i(e,s)}}const bs=Ve("log"),K=Ve("info"),ge=Ve("warn"),C={participantNumeralByState:void 0,participantByNumeral:void 0};function oe(t,e=!1){R(C.participantByNumeral);const s=t.getId();if(!Object.values(C.participantByNumeral).some(({getId:r})=>r()===s))throw e?new Error("The participant is not registered"):new J("Participant is not registered")}const Nt=t=>t==="one"?"two":"one";function gt(t){const e=t,s=Nt(e);C.participantNumeralByState={focused:e,opponent:s}}function de(t){let e;const s=t.getId();return R(C.participantByNumeral),Object.entries(C.participantByNumeral).forEach(([i,{getId:r}])=>{r()===s&&(e=i)}),R(e),e}function qe(t){let e=de(t);return e=Nt(e),R(C.participantByNumeral),t=C.participantByNumeral[e],t}function Es(t){return oe(t),R(C.participantByNumeral),C.participantByNumeral.one.getId()===t.getId()}class D{static setParticipants(e,s){if(e.getId()===s.getId())throw new J("Both participants are the same one");if(C.participantByNumeral={one:e,two:s},q(C.participantNumeralByState)){const i=Ns("one","two");gt(i)}}static setFocusedParticipant(e){const s=de(e);gt(s)}constructor(e,s=e){this.#e={one:e,two:s},this.#t={one:e,two:s}}#e;#t;getBy(e){return oe(e),this.#t[de(e)]}getOpponentBy(e){return oe(e),this.getBy(qe(e))}#s(e){const{participantByNumeral:s}=C;return R(s),s[e]}#i(e){const{participantNumeralByState:s}=C;R(s);const i=s[e];return this.#s(i)}#r=()=>this.#i("focused");#n=()=>this.#i("opponent");get=()=>this.getBy(this.#r());getOpponent=()=>this.getBy(this.#n());#o(e){return R(C.participantByNumeral),this.getBy(C.participantByNumeral[e])}getOfOne=()=>this.#o("one");getOfTwo=()=>this.#o("two");#a(){const e=this.getOfOne(),s=this.getOfTwo();return[e,s]}getAll=this.#a;#c(){const e=this.#a(),[s,i]=e;return Y(s),Y(i),[s,i]}getMax(){const[e,s]=this.#c();return Math.max(e,s)}getTotal(){const[e,s]=this.#c();return e+s}getParticipantIf(e){let s;return this.#g((i,r)=>{e(i)&&(s=r)}),s}#l(e,s){oe(e),this.#t[de(e)]=s}set(e){this.#l(this.#r(),e)}setOpponent(e){this.#l(this.#n(),e)}#h(e,s){R(C.participantByNumeral);const i=C.participantByNumeral[e];this.#l(i,s)}setOfOne(e){this.#h("one",e)}setOfTwo(e){this.#h("two",e)}#u(e){oe(e),this.#l(e,this.#e[de(e)])}#d(){this.#u(this.#r())}resetOpponent(){this.#u(this.#n())}resetAll(){this.#d(),this.resetOpponent()}increment(){let e=this.get();Y(e),e++,this.set(e)}swap(){const e=this.getOfOne(),s=this.getOfTwo();this.setOfOne(s),this.setOfTwo(e)}#f(e,s){const i=this.get();return Y(i),s(i,e)}isLessThan=e=>this.#f(e,(s,i)=>s<i);isDiffAtLeast(e){const s=this.getOfOne();Y(s);const i=this.getOfTwo();return Y(i),Math.abs(s-i)>=e}#g(e){this.#a().forEach((s,i)=>{const r=i===0?"one":"two",n=this.#s(r);e(s,n)})}some=e=>this.#a().some(e);clone=()=>new D(this.getOfOne(),this.getOfTwo())}const se=t=>A(t)?t.toString():"",$e=t=>Lt(t),Bt=t=>Fe(t)?t:[t];function _t(){bs("Alert, developer!:","font-size: 1.5em; font-weight: bold; color: red;")}class J extends Error{constructor(e){super(e),_t()}}class Z extends TypeError{constructor(e){super(e),_t()}}const me=t=>typeof t=="string",Ie=t=>typeof t=="number",As=t=>typeof t=="boolean",pt=t=>t===!0,$s=t=>typeof t=="function",Fe=t=>Array.isArray(t),q=t=>t===void 0,A=t=>t!=null,ie=(...t)=>t.filter(A).map(e=>`ss-${ws[e]}`).join(" ");function Ne(t,e,s=se){const i=t>e?"highlight":t<e?"lowlight":null;return`<span class="${ie(i)}">${s(t)}</span>`}const Q=()=>{},Is=t=>t;function Ns(...t){const e=Math.floor(Math.random()*t.length);return t[e]}const re=(t,e)=>$s(t)?t(e):t,Bs=t=>Number.isNaN(t),Rt=t=>t%2===0,Ft=t=>!Rt(t),Lt=t=>Ie(t)?t:me(t)?parseFloat(t):NaN;function Ct(t){Be(t);const e=["th","st","nd","rd"],s=t%100;return t+(e[(s-20)%10]||e[s]||e[0])}function _s(t,e){return t===0&&e===0?0:t/e*100}function Mt(t,e){return t===0&&e===0?0:`${t}/${e}`}const Rs=(t,e)=>t.padStart(e,"0"),He=t=>t>0,Dt=t=>Number.isInteger(t),Fs=t=>He(t)&&Dt(t),Ls=t=>t>=0&&Dt(t);function Be(t){if(!Fs(t))throw new Z(`Expected a positive integer, but received: ${t}`)}function Cs(t){if(!Ls(t))throw new Z(`Expected a non-negative integer, but received: ${t}`)}function Ms(t){if(!Ft(t))throw new Z(`Expected an odd number but received: ${t}`)}function Ds(t,e){if(!(t>e))throw new Z(`Expected a number greater than ${e}, but received: ${t}`)}function ks(t,e){if(!(t<e))throw new Z(`Expected a number less than ${e}, but received: ${t}`)}let mt=0;function xs(){return mt++,mt}class kt{constructor(e,s){this.type=e,this.name=s,this.id=xs()}id;getId=()=>this.id;getType=()=>this.type;getName=()=>this.name}class vt extends kt{constructor(e){super(pe.Player,e),this._}_=null}class Tt extends kt{constructor(e){super(pe.Team,e),this._}_=null}var pe=(t=>(t[t.Player=0]="Player",t[t.Team=1]="Team",t))(pe||{});const Ws={[pe.Player]:"player",[pe.Team]:"team"},Us=!1,G=!0;var X=(t=>(t[t.Basketball=0]="Basketball",t[t.Tennis=1]="Tennis",t[t.Volleyball=2]="Volleyball",t))(X||{}),x=(t=>(t[t.Unstarted=0]="Unstarted",t[t.Preparing=1]="Preparing",t[t.AtRest=2]="AtRest",t[t.Playing=3]="Playing",t[t.Finished=4]="Finished",t))(x||{}),j=(t=>(t[t.breakPerPhase=0]="breakPerPhase",t[t.breakPerPoint=1]="breakPerPoint",t[t.Timeout=2]="Timeout",t))(j||{});const xt="{{",Wt="}}",Pt=".",qs="one",Hs="two",je=[],js={[X.Basketball]:"basketball",[X.Tennis]:"tennis",[X.Volleyball]:"volleyball"},Gs=t=>Es(t)?qs:Hs;function Vs(t,e){return(me(t)?t:t.join(Pt))+(A(e)?Pt+Gs(e):"")}const Ut=t=>`${xt}${t}${Wt}`;function Oe(t,e){const s=Vs(t,e);return Ut(s)}class zs{constructor(e,s,i,r){this.#e=e,this.#t=s,this.#s=i,this.#i=r}#e;#t;#s;#i;get(e){let s=this.#e;return this.#t.forEach(([n,h])=>{[void 0,...e].forEach(c=>{const g=Oe(n,c),v=re(h,c);s=s.replace(g,v)})}),s.split(xt).map(n=>{const[h,c]=n.split(Wt);return A(c)?h:null}).filter(n=>A(n)).forEach(n=>{const h=Ut(n);s=s.replace(h,"")}),s===N&&(s="<!-- No content -->",this.#i.push("hidden")),s=`<div data-ss-sport="${js[this.#s]}" class="${ie("root",...this.#i)}">
				${s}
			</div>`,s=s.replace(/\t/g,""),s}}class Ys{#e={};#t(e,s){const i=this.#e[e];return A(i)?s(i):Ue}get=(e,s)=>this.#t(e,i=>i.getBy(s));getOfOne=e=>this.#t(e,s=>s.getOfOne());getOfTwo=e=>this.#t(e,s=>s.getOfTwo());makeAvailable(...e){e.forEach(s=>{this.#e[s]=new D(0)})}#s(e,s,i){let r=this.#e[e];if(q(r))throw new J("ID not available");D.setFocusedParticipant(s),i(r)}resetOpponent(e,s){this.#s(e,s,i=>{i.resetOpponent()})}increase(e,s){this.#s(e,s,i=>{i.increment()})}}var o=(t=>(t[t.TotalPoints=0]="TotalPoints",t[t.TwoPointersAttempted=1]="TwoPointersAttempted",t[t.TwoPointersMade=2]="TwoPointersMade",t[t.ThreePointersAttempted=3]="ThreePointersAttempted",t[t.ThreePointersMade=4]="ThreePointersMade",t[t.FreeThrowsAttempted=5]="FreeThrowsAttempted",t[t.FreeThrowsMade=6]="FreeThrowsMade",t[t.ConsecutivePointsWon=7]="ConsecutivePointsWon",t[t.MostConsecutivePointsWon=8]="MostConsecutivePointsWon",t[t.TotalServicePoints=9]="TotalServicePoints",t[t.Aces=10]="Aces",t[t.ServiceErrors=11]="ServiceErrors",t[t.PossibleBreakPoints=12]="PossibleBreakPoints",t[t.BreakPoints=13]="BreakPoints",t[t.FirstServesIn=14]="FirstServesIn",t[t.FirstServePointsWon=15]="FirstServePointsWon",t[t.TotalSecondServes=16]="TotalSecondServes",t[t.SecondServesIn=17]="SecondServesIn",t[t.SecondServePointsWon=18]="SecondServePointsWon",t[t.PointScoring=19]="PointScoring",t[t.TotalReceptionPoints=20]="TotalReceptionPoints",t[t.SideOut=21]="SideOut",t))(o||{});const Qs={[o.TotalPoints]:"Total Points",[o.TwoPointersAttempted]:"Two-Pointers Attempted",[o.TwoPointersMade]:"Two-Pointers Made",[o.ThreePointersAttempted]:"Three-Pointers Attempted",[o.ThreePointersMade]:"Three-Pointers Made",[o.FreeThrowsAttempted]:"Free Throws Attempted",[o.FreeThrowsMade]:"Free Throws Made",[o.MostConsecutivePointsWon]:"Most Consecutive Points Won",[o.Aces]:"Aces",[o.ServiceErrors]:t=>t!==X.Tennis?"Service Errors":"Double Faults",[o.BreakPoints]:"Break Points",[o.FirstServesIn]:"1st Serves In",[o.SecondServesIn]:"2nd Serves In",[o.FirstServePointsWon]:"1st Serve Points Won",[o.SecondServePointsWon]:"2nd Serve Points Won",[o.PointScoring]:"Point-Scoring",[o.SideOut]:"Side-Out"};class qt{constructor(e){this.config=e;const[s,i]=e.participants;this.verifyEachParticipantIsUnique(s,i),D.setParticipants(s,i),this.participant=new D(s,i),this.stats.makeAvailable(o.TotalPoints);let{timeouts:r}=e;A(r)&&(this.timeouts={...r,doneQty:new D(0)})}verifyEachParticipantIsUnique(e,s){if(e.getId()===s.getId())throw new Error("Both participants are the same one")}participant;stage=x.Unstarted;isUnstarted=()=>this.stage===x.Unstarted;isStarted=()=>this.stage!==x.Unstarted;isInactive=()=>this.isPreparing()||this.isAtRest();isPreparing=()=>this.stage===x.Preparing;isPlaying=()=>this.stage===x.Playing;isAtRest=()=>this.stage===x.AtRest;isAtBreakPerPhase=()=>this.isAtRest()&&this.restType===j.breakPerPhase;isInTimeout=()=>this.isAtRest()&&this.restType===j.Timeout;isFinished=()=>this.stage===x.Finished;getParticipantTypeName=()=>Ws[this.participant.getOfOne().getType()];getRootHtml(e,s,i=je){return new zs(e,i,this.config.sport,s).get(this.participant.getAll())}getUltimateScoreboard(e,s,i=je){return this.isUnstarted()?(e=N,ge("No scoreboard content")):e=`<table>
					<caption>Scoreboard</caption>
					${e}
				</table>`,this.getRootHtml(e,["scoreboard",s],i)}stats=new Ys;getUltimateStats(e,s){const i=[o.TotalPoints,...e],r=(h,c,g=N)=>`<th scope="${h}" class="${ie(c)}">${g}</th>`;let n=this.wasPlayed?i.map(h=>{const c=Fe(h)?h:[h],[g,v,O]=c,y=re(Qs[g],this.config.sport);R(y);const B=q(v),L=_=>{const k=_(g);if(B)return k;{if(me(k))return k;const W=_(v);return Y(W),O?Math.round(_s(k,W)):Lt(`${k}.${W}1`)}},P=L(this.stats.getOfOne),l=L(this.stats.getOfTwo),f=_=>_===Ue?NaN:_,T=f(P),S=f(l),$=_=>{if(O)return`${_}%`;const[k,W]=se(_).split("."),ee=$e(k),te=$e(W.substring(0,W.length-1)),ve=Mt(ee,te);return se(ve)},F=_=>Bs(_)?Ue:B?se(_):$(_);return`<tr>
							${r("row","labelLeft",M(y))}
							<td>${Ne(T,S,F)}</td>
							${r("row","labelRight",M(y))}
							<td>${Ne(S,T,F)}</td>
						</tr>`}).join(`
`):N;return n===N?ge("No stats content"):n=`<table>
					<caption>Stats</caption>
					<thead>
						<tr>
							${r("col","labelLeft")}
							<th scope="col">${M(this.participant.getOfOne().getName())}</th>
							${r("col","labelRight")}
							<th scope="col">${M(this.participant.getOfTwo().getName())}</th>
						</tr>
					</thead>
					<tbody>
						${n}
					</tbody>
				</table>`,this.getRootHtml(n,["stats",s])}panelElement;getUltimatePanel(e){const s=this.panelElement;if(A(s))return s;const i=[];let r=e.map(g=>`<div>${g.map(([O,y])=>(i.push(y),`<button>${M(O)}</button>`)).join("")}</div>`).join(`
`);r=`<div>
				<h1>Panel</h1>
				${r}
			</div>`,r=this.getRootHtml(r,["panel"]);const n=new DOMParser,h=n.parseFromString(r,"text/html"),c=h.body.firstElementChild;return R(c),i.forEach((g,v)=>{c.getElementsByTagName("button")[v].addEventListener("click",()=>{g()})}),this.panelElement=c,c}verifyParticipantIsRegistered(e){oe(e,!0)}verifyIsUnstarted(){if(!this.isUnstarted())throw new Error("The match is not unstarted")}verifyIsStarted(){if(!this.isStarted())throw new Error("The match is not started")}verifyIsInactive(){if(!this.isInactive())throw new Error("The match is not inactive")}verifyIsPreparing(){if(!this.isPreparing())throw new Error("The match is not being prepared")}verifyIsPlaying(){if(!this.isPlaying())throw new Error("The match is not being played")}verifyIsAtBreakPerPhase(e){if(!this.isAtRest()||this.restType!==j.breakPerPhase)throw new Error(`The match is not at ${e} break`)}dispatchEvent(){this.config.onChange()}start(e=Q){this.verifyIsUnstarted(),e(),this.stage=x.Preparing,K("The match starts being preparedâ€¦"),this.dispatchEvent()}wasPlayed=!1;play(e,s=Q,i=Q,r=()=>{this.verifyIsInactive()}){i(),r(),this.stage=x.Playing,s(),this.wasPlayed=!0,this.dispatchEvent()}timeouts;resetTimeouts(){A(this.timeouts)&&this.timeouts.doneQty.resetAll()}assertCanHandleTimeouts(e){if(!A(e))throw new J("Cannot handle timeouts")}verifyTimeoutIsDoneable(){if(!this.timeouts?.isDoneable())throw new Error("The timeout is not doneable")}verifyAllTimeoutsAreNotDone(e){const{timeouts:s}=this;if(s?.doneQty.getBy(e)===s?.qtyPerPhase())throw new Error(`${M(e.getName())} already did all the timeouts`)}grantTimeoutTo(e){this.assertCanHandleTimeouts(this.timeouts),this.verifyParticipantIsRegistered(e),this.verifyIsPlaying(),this.verifyTimeoutIsDoneable(),this.verifyAllTimeoutsAreNotDone(e),D.setFocusedParticipant(e),this.timeouts.doneQty.increment(),this.goToRest(j.Timeout)}restType;goToRest(e){this.stage=x.AtRest,this.restType=e,K(e!==j.Timeout?"The match is at breakâ€¦":"The match is in timeoutâ€¦"),this.dispatchEvent()}wasFinished=!1;finish(){this.stage=x.Finished,this.wasFinished=!0,this.dispatchEvent()}}const Ht=4,yt=Ht/2,St="MC",Ks=10,Xs=1,xe="SC",Js=24,Zs=5,ei=2,ti=3,si=2,ii=1;function ri(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fe={exports:{}},ni=fe.exports,wt;function oi(){return wt||(wt=1,(function(t,e){(function(s,i){i(e)})(ni,(function(s){function i(u,d){var m=Object.keys(u);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(u);d&&(E=E.filter(function(I){return Object.getOwnPropertyDescriptor(u,I).enumerable})),m.push.apply(m,E)}return m}function r(u){for(var d=1;d<arguments.length;d++){var m=arguments[d]!=null?arguments[d]:{};d%2?i(Object(m),!0).forEach(function(E){h(u,E,m[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(m)):i(Object(m)).forEach(function(E){Object.defineProperty(u,E,Object.getOwnPropertyDescriptor(m,E))})}return u}function n(u){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},n(u)}function h(u,d,m){return d=g(d),d in u?Object.defineProperty(u,d,{value:m,enumerable:!0,configurable:!0,writable:!0}):u[d]=m,u}function c(u,d){if(typeof u!="object"||u===null)return u;var m=u[Symbol.toPrimitive];if(m!==void 0){var E=m.call(u,d);if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(u)}function g(u){var d=c(u,"string");return typeof d=="symbol"?d:String(d)}function v(u,d,m){var E,I="";if(u=typeof u=="number"?String(u):u,u.length>d)return u;for(E=0;E<d;E=E+1)I+=String(m);return(I+u).slice(-I.length)}function O(){this.reset()}O.prototype.toString=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["hours","minutes","seconds"],d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:":",m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2;u=u||["hours","minutes","seconds"],d=d||":",m=m||2;var E=[],I;for(I=0;I<u.length;I=I+1)this[u[I]]!==void 0&&(u[I]==="secondTenths"?E.push(this[u[I]]):E.push(v(this[u[I]],m,"0")));return E.join(d)},O.prototype.reset=function(){this.secondTenths=0,this.seconds=0,this.minutes=0,this.hours=0,this.days=0};function y(){this.events={}}y.prototype.on=function(u,d){var m=this;return Array.isArray(this.events[u])||(this.events[u]=[]),this.events[u].push(d),function(){return m.removeListener(u,d)}},y.prototype.removeListener=function(u,d){if(Array.isArray(this.events[u])){var m=this.events[u].indexOf(d);m>-1&&this.events[u].splice(m,1)}},y.prototype.removeAllListeners=function(u){u?Array.isArray(this.events[u])&&(this.events[u]=[]):this.events={}},y.prototype.emit=function(u){for(var d=this,m=arguments.length,E=new Array(m>1?m-1:0),I=1;I<m;I++)E[I-1]=arguments[I];Array.isArray(this.events[u])&&this.events[u].forEach(function(ae){return ae.apply(d,E)})};var B=10,L=60,P=60,l=24,f=0,T=1,S=2,$=3,F=4,_="secondTenths",k="seconds",W="minutes",ee="hours",te="days",ve=[_,k,W,ee,te],ne={secondTenths:100,seconds:1e3,minutes:6e4,hours:36e5,days:864e5},Jt={secondTenths:B,seconds:L,minutes:P,hours:l};function Le(u,d){return(u%d+d)%d}function ze(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=new O,m=new O,E,I=new y,ae=!1,Te=!1,le,Pe,Ce,Ye={},Me,V,z,De,ce,Qe,U={detail:{timer:this}};st(u);function Zt(a,p){var w=Jt[a];m[a]=p,a===te?d[a]=Math.abs(p):p>=0?d[a]=Le(p,w):d[a]=Le(w-Le(p,w),w)}function es(a){return he(a,te)}function ts(a){return he(a,ee)}function ss(a){return he(a,W)}function is(a){return he(a,k)}function rs(a){return he(a,_)}function he(a,p){var w=m[p];return Zt(p,ue(a,ne[p])),m[p]!==w}function Ke(){Xe(),ls()}function Xe(){clearInterval(E),E=void 0,ae=!1,Te=!1}function Je(a){ct()?(ce=Ze(),V=ke(Me.target)):st(a),ns()}function ns(){var a=ne[le];tt(ye(Date.now()))||(E=setInterval(os,a),ae=!0,Te=!1)}function Ze(){return ye(Date.now())-m.secondTenths*ne[_]*Pe}function os(){var a=ye(Date.now()),p=et();as(p),Ce(U.detail.timer),tt(a)&&(nt(),H("targetAchieved",U))}function et(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ye(Date.now()),p=Pe>0?a-ce:ce-a,w={};return w[_]=rs(p),w[k]=is(p),w[W]=ss(p),w[ee]=ts(p),w[te]=es(p),w}function ye(a){return Math.floor(a/ne[le])*ne[le]}function as(a){a[_]&&H("secondTenthsUpdated",U),a[k]&&H("secondsUpdated",U),a[W]&&H("minutesUpdated",U),a[ee]&&H("hoursUpdated",U),a[te]&&H("daysUpdated",U)}function tt(a){return V instanceof Array&&a>=Qe}function ls(){d.reset(),m.reset()}function st(a){a=a||{},le=cs(a.precision),Ce=typeof a.callback=="function"?a.callback:function(){},De=a.countdown===!0,Pe=De===!0?-1:1,n(a.startValues)==="object"?us(a.startValues):z=null,ce=Ze(),et(),n(a.target)==="object"?V=ke(a.target):De?(a.target={seconds:0},V=ke(a.target)):V=null,Ye={precision:le,callback:Ce,countdown:n(a)==="object"&&a.countdown===!0,target:V,startValues:z},Me=a}function cs(a){if(a=typeof a=="string"?a:k,!hs(a))throw new Error("Error in precision parameter: ".concat(a," is not a valid value"));return a}function hs(a){return ve.indexOf(a)>=0}function it(a){var p;if(n(a)==="object")if(a instanceof Array){if(a.length!==5)throw new Error("Array size not valid");p=a}else{for(var w in a)if(ve.indexOf(w)<0)throw new Error("Error in startValues or target parameter: ".concat(w," is not a valid input value"));p=[a.secondTenths||0,a.seconds||0,a.minutes||0,a.hours||0,a.days||0]}p=p.map(function(ys){return parseInt(ys,10)});var ht=p[f],ut=p[T]+ue(ht,B),dt=p[S]+ue(ut,L),ft=p[$]+ue(dt,P),Ps=p[F]+ue(ft,l);return p[f]=ht%B,p[T]=ut%L,p[S]=dt%P,p[$]=ft%l,p[F]=Ps,p}function ue(a,p){var w=a/p;return w<0?Math.ceil(w):Math.floor(w)}function ke(a){if(a){V=it(a);var p=rt(V);return Qe=ce+p.secondTenths*ne[_]*Pe,V}}function us(a){z=it(a),d.secondTenths=z[f],d.seconds=z[T],d.minutes=z[S],d.hours=z[$],d.days=z[F],m=rt(z,m)}function rt(a,p){var w=p||{};return w.days=a[F],w.hours=w.days*l+a[$],w.minutes=w.hours*P+a[S],w.seconds=w.minutes*L+a[T],w.secondTenths=w.seconds*B+a[[f]],w}function nt(){Ke(),H("stopped",U)}function ds(){Ke(),Je(Me),H("reset",U)}function fs(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};a=r(r({},u),a),!lt()&&(Je(a),H("started",U))}function gs(){Xe(),Te=!0,H("paused",U)}function ot(a,p){I.on(a,p)}function at(a,p){I.removeListener(a,p)}function ps(a){I.removeAllListeners(a)}function H(a,p){I.emit(a,p)}function lt(){return ae}function ct(){return Te}function ms(){return d}function vs(){return m}function Ts(){return Ye}typeof this<"u"&&(this.start=fs,this.pause=gs,this.stop=nt,this.reset=ds,this.isRunning=lt,this.isPaused=ct,this.getTimeValues=ms,this.getTotalTimeValues=vs,this.getConfig=Ts,this.addEventListener=ot,this.on=ot,this.removeEventListener=at,this.removeAllEventListeners=ps,this.off=at)}s.Timer=ze,s.default=ze,Object.defineProperty(s,"__esModule",{value:!0})}))})(fe,fe.exports)),fe.exports}var ai=oi();const Se=!0;class li{constructor(e){const s=e.map(i=>{const{initialTime:r}=i;Cs(r);const{onFinish:n}=i,h=A(n),{decimaledTime:c}=i;return A(c)&&(Be(c),h?ks(c,r):Ds(c,r)),{...i,value:new ai.Timer({precision:"secondTenths",countdown:h}),time:Se,shouldShowDecimal:!1,isFinished:!1}});this.#e=s,this.#s(i=>{const{onChange:r,value:n}=i,h=()=>{i.time=Se,r()};n.on("secondTenthsUpdated",()=>{let{shouldShowDecimal:c}=i;if(!c){const{decimaledTime:g}=i;if(A(g)){const O=g*10,{secondTenths:y}=n.getTotalTimeValues();c=O===y}}if(c)h(),i.shouldShowDecimal=!0;else{const{secondTenths:g}=n.getTimeValues();g===0&&h()}}),n.on("targetAchieved",()=>{r(),i.onFinish?.(),i.isFinished=!0})})}#e;#t=!1;isRunning=!1;#s(e,s){const i=A(s);if(i){const r=!s,n=this.isRunning;if(r!==n)throw new J(n?"Timer is already running":"Timer is not running")}this.#e.forEach(e),i&&(this.isRunning=s)}#i(e){const s=this.#e.find(({id:i})=>i===e);if(q(s))throw new J("ID not found");return s}getTimeOf(e){const s=this.#i(e);let{time:i}=s;if(i!==Se)return i;const{value:r}=s,n=r.getTimeValues(),{hours:h}=r.getTotalTimeValues(),{minutes:c,seconds:g}=n;let v=se(g);const{shouldShowDecimal:O}=s;if(O){const{secondTenths:l}=n;v=`${g}.${l}`}let y=[{symbol:"H",value:se(h)},{symbol:"M",value:se(c)},{symbol:"S",value:v}],B=!1;y=y.filter(({value:l},f)=>{if(B||f===y.length-1)return!0;const S=$e(l);return He(S)?(B=!0,!0):!1});const L=y.map(({value:l},f)=>{if(!(f===0)){const[S,$]=l.split("."),F=Rs(S,2);l=A($)?`${F}.${$}`:F}return l}).join(":");let P=y.filter(({value:l})=>{const f=$e(l);return He(f)}).map(({value:l,symbol:f})=>(l=l.replace(".0",""),l+f)).join("");return P===N&&(P="0S"),P="PT"+P,i=`<time datetime="${P}">${L}</time>`,s.time=i,i}reset(e){const s=me(e),i=s?this.#i(e):e,{value:r,initialTime:n}=i;r.stop(),r.start({startValues:{seconds:n}}),this.isRunning||r.pause(),i.time=Se,i.shouldShowDecimal=!1,i.isFinished=!1,i.onChange()}resetAll(){this.#s(e=>{this.reset(e)}),this.#t=!0}runAll(){this.#t||this.resetAll(),this.#s(({value:e})=>{e.start()},!0)}pauseAll(){this.#s(({value:e})=>{e.pause()},!1)}}class ci extends qt{constructor(e,s,i){super({sport:X.Basketball,participants:[e,s],onChange:i,timeouts:{qtyPerPhase:()=>this.parts.current<=yt?ei:ti,isDoneable:()=>this.isPaused()}});const r=()=>{this.dispatchEvent()},n=[{id:St,initialTime:Ks*60,decimaledTime:Xs*60,onChange:r,onFinish:()=>{this.finishPart()}},{id:xe,initialTime:Js,decimaledTime:Zs,onChange:r,onFinish:()=>{this._pause(()=>{K("The shot clock is over"),this.switchBallPossession(),this.shouldResetShotClock=!0})}}];this.timer=new li(n),this.parts={current:1,total:Ht},this.stats.makeAvailable(o.TwoPointersAttempted,o.TwoPointersMade,o.ThreePointersAttempted,o.ThreePointersMade,o.FreeThrowsAttempted,o.FreeThrowsMade)}timer;parts;isRunning=()=>this.timer.isRunning;isPaused=()=>!this.isRunning();getScoreboard(){const e=[`<th scope="col">${M(this.getParticipantTypeName())}</th>`,'<th scope="col">Points</th>'],s=this.isStarted(),i=this.hasBallPossession.some(pt),r=h=>{const c=this.participant[h?"getOfTwo":"getOfOne"]();return[`<th scope="row">${M(this.participant.getBy(c).getName())}</th>`,`<td>${this.stats.get(o.TotalPoints,c)}</td>`]},n=h=>`<span class="${ie(this.isRunning()?null:"lowlight")}">${this.timer.getTimeOf(h)}</span>`;return this.getUltimateScoreboard(`<thead>
					<tr>
						${e.join("")}
						${e.reverse().join("")}
						${s?'<th scope="col">Part</th>':N}
						${s?'<th scope="col">Time</th>':N}
						${i?'<th scope="col">Possession</th>':N}
					</tr>
				</thead>
				<tbody>
					<tr>
						${r(!1).join("")}
						${r(!0).reverse().join("")}
						${s?`<td>${Ct(this.parts.current)}</td>`:N}
						${s?`<td>${n(St)}</td>`:N}
						${i?`<td>${n(xe)}</td>`:N}
					</tr>
				</tbody>`)}getStats=()=>this.getUltimateStats([o.TwoPointersAttempted,[o.TwoPointersMade,o.TwoPointersAttempted,G],o.ThreePointersAttempted,[o.ThreePointersMade,o.ThreePointersAttempted,G],o.FreeThrowsAttempted,[o.FreeThrowsMade,o.FreeThrowsAttempted,G]]);getPanel(){const e=this.participant.getOfOne(),s=this.participant.getOfTwo();return this.getUltimatePanel([[["Start",()=>{this.start()}]],[["Play with team 1 as opening ball possessor",()=>{this.play(e)}],["Play with team 2 as opening ball possessor",()=>{this.play(s)}]],[["Grant timeout to team 1",()=>{this.grantTimeoutTo(e)}],["Grant timeout to team 2",()=>{this.grantTimeoutTo(s)}]],[["Play",()=>{this.play()}]],[["Log ball possession of team 1",()=>{this.logBallPossessionOf(e)}],["Log ball possession of team 2",()=>{this.logBallPossessionOf(s)}]],[["Pause",()=>{this.pause()}],["Resume",()=>{this.resume()}]],[["Log two-pointer failed",()=>{this.logTwoPointerFailed()}],["Log two-pointer made",()=>{this.logTwoPointerMade()}]],[["Log three-pointer failed",()=>{this.logThreePointerFailed()}],["Log three-pointer made",()=>{this.logThreePointerMade()}]],[["Log free throw failed",()=>{this.logFreeThrowFailed()}],["Log free throw made",()=>{this.logFreeThrowMade()}]],[["Prepare",()=>{this.prepare()}]]])}verifyIsPlayingOrAtRest(){if(!this.isPlaying()&&!this.isAtRest())throw new Error("The match is not being playing nor is at rest")}verifyIsNotPaused(){if(this.isPaused())throw new Error("The match is already paused")}verifyIsPaused(){if(!this.isPaused())throw new Error("The match is not paused")}verifyIsInTimeoutOrPreparing(){if(!this.isInTimeout()&&!this.isPreparing())throw new Error("The match is not in timeout nor is being prepared")}isInFreeThrowsSituation=()=>this.doneFreeThrows>0;verifyIsNotInFreeThrowsSituation(){if(this.isInFreeThrowsSituation())throw new Error("The match is in free throws situation")}start(){super.start(()=>{this.timer.resetAll()})}verifyOpeningBallPossessorIsOk(e){const s=A(e);if(this.wasPlayed)s&&ge("The opening ball possessor is unrequired");else if(!s)throw new Error("An opening ball possessor is required")}play(e){const s=A(e);super.play(void 0,()=>{!this.wasPlayed&&s&&this.logBallPossessionOf(e),this.timer.runAll()},()=>{s&&this.verifyParticipantIsRegistered(e)},()=>{s?this.verifyIsPreparing():this.verifyIsInTimeoutOrPreparing(),this.verifyOpeningBallPossessorIsOk(e)})}grantTimeoutTo(e){super.grantTimeoutTo(e)}hasBallPossession=new D(!1);switchBallPossession(){this.hasBallPossession.swap(),this.possibleFreeThrows=0}getBallPossessor(){const e=this.hasBallPossession.getParticipantIf(pt);return R(e),e}shouldResetShotClock=!1;resetShotClock(){this.timer.reset(xe)}verifyCanChangeBallPossession(){if(this.isInFreeThrowsSituation()&&!this.wasOutOfTimeFieldBasketAttempted)throw new Error("Cannot change ball possession")}logBallPossessionOf(e){this.verifyParticipantIsRegistered(e),this.verifyIsPlaying(),this.verifyCanChangeBallPossession(),D.setFocusedParticipant(e),this.hasBallPossession.get()?ge(`${M(e.getName())} already has ball possession`):this.hasBallPossession.getOpponent()?(this.switchBallPossession(),this.isRunning()?this.resetShotClock():(K(`${M(e.getName())} has ball possession`),this.shouldResetShotClock=!0)):this.hasBallPossession.set(!0)}handleTime(e){this.verifyIsPlaying(),e()}_pause(e){this.handleTime(()=>{this.verifyIsNotPaused(),this.timer.pauseAll(),e(),this.dispatchEvent()})}pause(){this._pause(()=>{this.possibleFreeThrows=si})}resume(){this.handleTime(()=>{this.verifyIsPaused(),this.shouldResetShotClock&&(this.resetShotClock(),this.shouldResetShotClock=!1),this.wasOutOfTimeFieldBasketAttempted&&(this.wasOutOfTimeFieldBasketAttempted=!1),this.possibleFreeThrows>0&&(this.possibleFreeThrows=0),this.doneFreeThrows>0&&(this.doneFreeThrows=0),this.timer.runAll(),this.dispatchEvent()})}logBasket(e,s,i,r,n=Q,h=Q){this.verifyIsPlayingOrAtRest(),n();const c=this.getBallPossessor();if(this.stats.increase(s,c),r){this.stats.increase(i,c);for(let g=0;g<e;g++)this.stats.increase(o.TotalPoints,this.getBallPossessor())}h(),this.dispatchEvent()}wasOutOfTimeFieldBasketAttempted=!1;verifyAttemptedOutOfTimeFieldBasketIsUnique(){if(this.wasOutOfTimeFieldBasketAttempted)throw new Error("The attempted out-of-time field basket is not unique")}logFieldBasket(e,s,i,r){this.logBasket(e,s,i,r,()=>{this.verifyAttemptedOutOfTimeFieldBasketIsUnique(),this.verifyIsNotInFreeThrowsSituation()},()=>{if(!this.isPaused())r&&(this.switchBallPossession(),this.resetShotClock());else{this.wasOutOfTimeFieldBasketAttempted=!0;const n=!r;this.possibleFreeThrows=n?ii:e}})}logTwoPointer(e){this.logFieldBasket(2,o.TwoPointersAttempted,o.TwoPointersMade,e)}logTwoPointerFailed(){this.logTwoPointer(!1)}logTwoPointerMade(){this.logTwoPointer(!0)}logThreePointer(e){this.logFieldBasket(3,o.ThreePointersAttempted,o.ThreePointersMade,e)}logThreePointerFailed(){this.logThreePointer(!1)}logThreePointerMade(){this.logThreePointer(!0)}possibleFreeThrows=0;verifyHasPossibleFreeThrows(){if(this.doneFreeThrows>=this.possibleFreeThrows){const s=this.getBallPossessor();throw new Error(`${M(s.getName())} has no possible free throws`)}}doneFreeThrows=0;logFreeThrow(e){this.logBasket(1,o.FreeThrowsAttempted,o.FreeThrowsMade,e,()=>{this.verifyIsPaused(),this.verifyHasPossibleFreeThrows()},()=>{this.doneFreeThrows++,this.shouldResetShotClock=!0})}logFreeThrowFailed(){this.logFreeThrow(!1)}logFreeThrowMade(){this.logFreeThrow(!0)}finishPart(){this.pause();const{current:e,total:s}=this.parts;e<s?(this.goToRest(j.breakPerPhase),e===yt&&this.resetTimeouts()):this.finish(),this.dispatchEvent()}prepare(){this.verifyIsStarted(),this.verifyIsAtBreakPerPhase("quarter"),this.switchBallPossession(),this.parts.current++,this.timer.resetAll(),this.stage=x.Preparing,K("The quarter is being preparedâ€¦"),this.dispatchEvent()}}function hi(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var be={exports:{}},ui=be.exports,Ot;function di(){return Ot||(Ot=1,(function(t,e){(function(s,i){typeof hi=="function"?t.exports=i():s.pluralize=i()})(ui,function(){var s=[],i=[],r={},n={},h={};function c(l){return typeof l=="string"?new RegExp("^"+l+"$","i"):l}function g(l,f){return l===f?f:l===l.toLowerCase()?f.toLowerCase():l===l.toUpperCase()?f.toUpperCase():l[0]===l[0].toUpperCase()?f.charAt(0).toUpperCase()+f.substr(1).toLowerCase():f.toLowerCase()}function v(l,f){return l.replace(/\$(\d{1,2})/g,function(T,S){return f[S]||""})}function O(l,f){return l.replace(f[0],function(T,S){var $=v(f[1],arguments);return g(T===""?l[S-1]:T,$)})}function y(l,f,T){if(!l.length||r.hasOwnProperty(l))return f;for(var S=T.length;S--;){var $=T[S];if($[0].test(f))return O(f,$)}return f}function B(l,f,T){return function(S){var $=S.toLowerCase();return f.hasOwnProperty($)?g(S,$):l.hasOwnProperty($)?g(S,l[$]):y($,S,T)}}function L(l,f,T,S){return function($){var F=$.toLowerCase();return f.hasOwnProperty(F)?!0:l.hasOwnProperty(F)?!1:y(F,F,T)===F}}function P(l,f,T){var S=f===1?P.singular(l):P.plural(l);return(T?f+" ":"")+S}return P.plural=B(h,n,s),P.isPlural=L(h,n,s),P.singular=B(n,h,i),P.isSingular=L(n,h,i),P.addPluralRule=function(l,f){s.push([c(l),f])},P.addSingularRule=function(l,f){i.push([c(l),f])},P.addUncountableRule=function(l){if(typeof l=="string"){r[l.toLowerCase()]=!0;return}P.addPluralRule(l,"$0"),P.addSingularRule(l,"$0")},P.addIrregularRule=function(l,f){f=f.toLowerCase(),l=l.toLowerCase(),h[l]=f,n[f]=l},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"]].forEach(function(l){return P.addIrregularRule(l[0],l[1])}),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(function(l){return P.addPluralRule(l[0],l[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(l){return P.addSingularRule(l[0],l[1])}),["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","species","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[eÃ©]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(P.addUncountableRule),P})})(be)),be.exports}var fi=di();const gi=ri(fi),Ge=!0,bt=!1;var b=(t=>(t[t.Point=0]="Point",t[t.Game=1]="Game",t[t.Set=2]="Set",t))(b||{});class pi{constructor(e,s,i){if(e.at(0)?.scoreLevel!==b.Point)throw new J("1st score level must be point's");this.#e=e.map(r=>({...r,transformer:r.transformer??Is,qty:new D(0),detailedQty:[]})),this.#s=s,this.#i=i}#e;#t=[];#s;#i;#r(e){const{qty:s}=e,i=re(e.target,this);return s.isLessThan(i)?!1:!re(e.withLead,this)||s.isDiffAtLeast(2)}isOnePointToWin(){const e=this.getBy(b.Point),s=e.qty.clone();s.increment();const i={...e,qty:s};return this.#r(i)}getBy(e){const s=this.#e.find(({scoreLevel:i})=>i===e);return R(s),s}getNestedPoints(...e){let s=this.#t;if(e.forEach(i=>{Os(s);const r=s.at(i);R(r),s=r}),!(s instanceof D))throw new J("Result must be dual metric");return s}#n(){let e;this.forEach(s=>{A(e)&&s.detailedQty.push(e);const{scoreLevel:i,qty:r}=s,n=c=>{let g=this.#i[i];A(g)&&Bt(g).forEach(v=>{v(this,c)})};if(r.increment(),i===b.Point){let c=this.#t,g,v;this.forReversedEach(({scoreLevel:O,qty:y})=>{if(O!==b.Point){Fe(g)&&(c=g),v=y.getTotal();let B=c.at(v);q(B)&&(B=c[v]=[]),g=B}else c[v]=y.clone()})}if(!this.#r(s))return n(!Ge),Ge;if(i!==b.Set)return e=r.clone(),r.resetAll(),n(!bt),bt;this.#s()})}increment(e){if(e===b.Point)this.#n();else for(const s=()=>this.getBy(e).qty.get(),i=s();i===s();this.#n());}#o(e,s){for(let i in e){const r=e[i];if(s(r))break}}forEach(e){this.#o(this.#e,e)}forReversedEach(e){this.#o(this.#e.toReversed(),e)}}const mi={[b.Game]:"game",[b.Point]:"point",[b.Set]:"set"};class jt extends qt{constructor(e){super(e),this.ownConfig=e,this.verifyConfigIsOk(e);const s=e.scoreLevelsConfig.map(n=>{if(!Ie(n))return n;const h=n,c=(h+1)/2;return n={scoreLevel:b.Set,target:c,withLead:!1},n}),{onNewByScoreLevel:i={}}=e;function r(n,h){let c=i[n]??[];c=Bt(c),c.push(h),i[n]=c}r(b.Point,()=>{this.resetServes()}),r(b.Set,()=>{this.goToRest(j.breakPerPhase)}),this.scorer=new pi(s,()=>{this.finish()},i),this.stats.makeAvailable(o.ConsecutivePointsWon,o.MostConsecutivePointsWon,o.TotalServicePoints,o.Aces,o.ServiceErrors)}verifyConfigIsOk(e){e.scoreLevelsConfig.forEach(s=>{if(!Ie(s))return;const i=s;Be(i),Ms(i)}),Be(e.serve.qtyPerPoint)}scorer;openingServer;getServer(){if(q(this.openingServer))return;const e=this.ownConfig.serve.getServer(this.scorer);return As(e)?e?this.openingServer:qe(this.openingServer):e}getReceiver(){const e=this.getServer();return R(e),qe(e)}getClassName=()=>re(this.ownConfig.className,this.scorer);getCols(e,s,i){let r=N;const{scorer:n}=this;return n.forReversedEach(h=>{const{scoreLevel:c}=h;if(c===b.Point&&(this.isPreparing()||this.isAtBreakPerPhase()))return;const v=c===b.Set;if(this.isFinished()&&!v)return Ge;const{target:O}=h,y=mi[c];function B(T,S=!1){if(q(i))return NaN;const{transformer:$}=h,F=T.getBy(i),_=T.getOpponentBy(i);return S?$(_,F,n):$(F,_,n)}const L=T=>({focused:{original:A(i)?T.getBy(i):NaN,transformed:B(T)},opponent:{original:A(i)?T.getOpponentBy(i):NaN,transformed:B(T,!0)}});if(!v||s){const T=v&&this.wasFinished;r+=e({scoreLevel:{scoreLevel:c,target:O,name:gi(y),isConcluded:T},values:L(h.qty)})}v&&!s&&h.detailedQty.forEach((T,S)=>{r+=e({scoreLevel:{scoreLevel:c,target:O,name:`${Ct(S+1)} ${y}`,index:S,isConcluded:!0},values:L(T)})})}),r}getServeTag(e,s){if(this.isFinished())return N;const i=this.getServer();if(q(i))return N;let r=N;if(A(s)){const n=["serve"];s!==i&&n.push("invisible"),r=`<span class="${ie(...n)}"></span>`}return e=re(e,r),e}getRow(e,s,i){let r=this.getCols(({scoreLevel:{scoreLevel:n,target:h,index:c,isConcluded:g},values:{focused:{original:v,transformed:O},opponent:{original:y,transformed:B}}})=>{let L;n===b.Point&&v<y&&(L=re(h,this.scorer)<=y?"disadvantaged":null),me(O)&&(O=M(O)),g&&(Y(O),Y(B),O=Ne(O,B));const P=n===b.Set&&A(c)?Oe(["addingToGamesOfSet",c],i):N;return`<td class="${ie(L)}"><span class="${ie("content")}">${O}${P}</span></td>`},e,i);return r=`<tr>
				<th scope="row">
					${s?N:this.getServeTag(n=>`<span>${n}</span>`,i)}
					${M(i.getName())}
				</th>
				${r}
				${s?this.getServeTag(n=>`<td>${n}</td>`,i):N}
				${this.isFinished()?N:Oe("extraTd",i)}
			</tr>`,r}getDefinedScoreboard=(e=je,s=!1,i=!1)=>this.getUltimateScoreboard(`<thead>
			<tr>
				<th scope="col">${M(this.getParticipantTypeName())}</th>
				${this.getCols(({scoreLevel:{name:r}})=>`<th scope="col">${M(r)}</th>`,s)}
				${i?this.getServeTag('<th scope="col">Serve</th>'):N}
				${this.isFinished()?N:Oe("extraTh")}
			</tr>
		</thead>
		<tbody>
			${this.ownConfig.participants.map(r=>this.getRow(s,i,r)).join("")}
		</tbody>`,this.getClassName(),e);getDefinedStats=(e=[])=>this.getUltimateStats([o.MostConsecutivePointsWon,o.Aces,...e],this.getClassName());start(){super.start()}verifyOpeningServerIsAssigned(){if(A(this.openingServer))throw new Error("The match already has an opening server")}grantOpeningServeTo(e){this.verifyParticipantIsRegistered(e),this.verifyIsPreparing(),e===this.openingServer?ge(`${M(e.getName())} is already the opening server`):(this.verifyOpeningServerIsAssigned(),this.openingServer=e,this.dispatchEvent())}verifyOpeningServerIsRequired(){if(q(this.openingServer))throw new Error("An opening server is required")}play(e,s=Q){super.play(e,()=>{this.resetServes(),s()},Q,()=>{this.verifyIsInactive(),this.verifyOpeningServerIsRequired()})}failedServes;resetServes(){this.failedServes=0}logServeAsFault(){if(this.verifyIsPlaying(),R(this.failedServes),this.failedServes++,this.failedServes!==this.ownConfig.serve.qtyPerPoint)K("The serve is fault");else{const e=this.getServer();R(e),this.stats.increase(o.ServiceErrors,e);const s=this.getReceiver();this.logPointWonBy(s),this.resetServes()}this.dispatchEvent()}logServeAsAce(){this.verifyIsPlaying();const e=this.getServer();R(e),this.stats.increase(o.Aces,e),this.logPointWonBy(e)}logPointAsLet(){this.verifyIsPlaying(),this.resetServes(),K("Let point")}logPointWonBy(e,s=Q,i=Q){this.verifyParticipantIsRegistered(e),this.verifyIsPlaying(),this.stats.increase(o.TotalPoints,e),this.stats.increase(o.ConsecutivePointsWon,e),this.stats.resetOpponent(o.ConsecutivePointsWon,e),this.stats.get(o.ConsecutivePointsWon,e)>this.stats.get(o.MostConsecutivePointsWon,e)&&this.stats.increase(o.MostConsecutivePointsWon,e);const r=this.getServer();R(r),this.stats.increase(o.TotalServicePoints,r);const n=this.getReceiver();s(r,n,r===e),D.setFocusedParticipant(e),this.scorer.increment(b.Point),i(),this.dispatchEvent()}}const vi=3,Gt=6,Ti=4,Pi=7,Vt=2*Gt,Et=Vt+1,At=[0,15,30,40],yi="Ad",$t=2,Ee=t=>t.getBy(b.Game).qty.getTotal(),we=t=>Ee(t)===Vt;class zt extends jt{constructor(e,s,i){super({sport:X.Tennis,participants:[e,s],onChange:i,scoreLevelsConfig:[{scoreLevel:b.Point,target:r=>we(r)?Pi:Ti,withLead:!0,transformer:(r,n,h)=>{if(we(h))return r;const c=At[r];if(A(c))return c;if(r>n)return yi;const g=At.at(-1);return R(g),g}},{scoreLevel:b.Game,target:Gt,withLead:r=>Ee(r)!==Et},vi],serve:{qtyPerPoint:$t,getServer:r=>{const n=r.getBy(b.Set).detailedQty.map(v=>v.getTotal()).reduce((v,O)=>v+O,0),h=Ee(r);let c=n+h;return we(r)&&(c+=Math.ceil(r.getBy(b.Point).qty.getTotal()/2)),Rt(c)}},onNewByScoreLevel:{[b.Game]:(r,n)=>{if(n)return;const h=Ee(r);Ft(h)&&this.goToRest(j.breakPerPhase)}},className:r=>we(r)?"isInTieBreak":null}),this.stats.makeAvailable(o.ServiceErrors,o.PossibleBreakPoints,o.BreakPoints,o.TotalServicePoints,o.FirstServesIn,o.FirstServePointsWon,o.TotalSecondServes,o.SecondServesIn,o.SecondServePointsWon)}getScoreboard(){const e=[],{scorer:s}=this;return s.getBy(b.Set).detailedQty.forEach((i,r)=>{if(i.getTotal()===Et){const n=s.getNestedPoints(r,-1);e.push([["addingToGamesOfSet",r],h=>{if(q(h))return N;const c=n.getBy(h),g=n.getOpponentBy(h);return`<sup>${Ne(c,g)}</sup>`}])}}),this.getDefinedScoreboard(e)}getStats=()=>this.getDefinedStats([o.ServiceErrors,[o.BreakPoints,o.PossibleBreakPoints,Us],[o.FirstServesIn,o.TotalServicePoints,G],[o.SecondServesIn,o.TotalSecondServes,G],[o.FirstServePointsWon,o.FirstServesIn,G],[o.SecondServePointsWon,o.SecondServesIn,G]]);getPanel(){const e=this.participant.getOfOne(),s=this.participant.getOfTwo();return this.getUltimatePanel([[["Start",()=>{this.start()}]],[["Grant opening serve to player 1",()=>{this.grantOpeningServeTo(e)}],["Grant opening serve to player 2",()=>{this.grantOpeningServeTo(s)}]],[["Play",()=>{this.play()}]],[["Log serve as let",()=>{this.logServeAsLet()}],["Log serve as fault",()=>{this.logServeAsFault()}],["Log serve as ace",()=>{this.logServeAsAce()}]],[["Log point as let",()=>{this.logPointAsLet()}]],[["Log point won by player 1",()=>{this.logPointWonBy(e)}],["Log point won by player 2",()=>{this.logPointWonBy(s)}]]])}play(){super.play()}logServeAsLet(){this.verifyIsPlaying(),K("Let serve")}hasPossibleBreakPoint=!1;logPointWonBy(e){super.logPointWonBy(e,(s,i,r)=>{!r&&this.hasPossibleBreakPoint&&this.stats.increase(o.BreakPoints,i),this.hasPossibleBreakPoint=!1,R(this.failedServes),this.failedServes>0&&this.stats.increase(o.TotalSecondServes,s);const c=this.failedServes===0,g=!c&&this.failedServes!==$t;c?this.stats.increase(o.FirstServesIn,s):g&&this.stats.increase(o.SecondServesIn,s),r&&(c?this.stats.increase(o.FirstServePointsWon,s):g&&this.stats.increase(o.SecondServePointsWon,s))},()=>{const s=this.getReceiver();D.setFocusedParticipant(s),this.scorer.isOnePointToWin()&&(this.stats.increase(o.PossibleBreakPoints,s),this.hasPossibleBreakPoint=!0)})}}const Yt=5,Si=Yt-1,wi=25,Oi=15,bi=2,Ei=1,Ai=[8,16],$i=[],Ii=1,Ae=t=>t.getBy(b.Set).qty.getTotal()===Si,It=t=>Ae(t)?Ei:bi;class Ni extends jt{constructor(e,s,i){super({sport:X.Volleyball,participants:[e,s],onChange:i,timeouts:{qtyPerPhase:()=>It(this.scorer),isDoneable:()=>this.isSomePointDone},scoreLevelsConfig:[{scoreLevel:b.Point,target:r=>Ae(r)?Oi:wi,withLead:!0},Yt],serve:{qtyPerPoint:Ii,getServer:()=>this.isLastPointWon.get()===this.isLastPointWon.getOpponent()?!0:this.isLastPointWon.getOfOne()?e:s},onNewByScoreLevel:{[b.Point]:(r,n)=>{if(!n&&(this.isSomePointDone=!0,!Ae(r))){const h=r.getBy(b.Point).qty.getMax();this.pendingPointsMaxToGoToRest.has(h)&&(this.goToRest(j.breakPerPoint),this.pendingPointsMaxToGoToRest.delete(h))}},[b.Set]:()=>{this.resetTimeouts(),this.resetPendingPointsMaxToGoToRest()}}}),this.stats.makeAvailable(o.TotalServicePoints,o.ServiceErrors,o.PointScoring,o.TotalReceptionPoints,o.SideOut),this.resetPendingPointsMaxToGoToRest()}isLastPointWon=new D(!1);getScoreboard=()=>this.getDefinedScoreboard([["extraTh",'<th scope="col">Timeouts</th>'],["extraTd",e=>A(e)?`<td>${Mt(this.timeouts?.doneQty.getBy(e)??0,It(this.scorer))}</td>`:N]],!0,!0);getStats=()=>this.getDefinedStats([[o.ServiceErrors,o.TotalServicePoints,G],[o.PointScoring,o.TotalServicePoints,G],[o.SideOut,o.TotalReceptionPoints,G]]);getPanel(){const e=this.participant.getOfOne(),s=this.participant.getOfTwo();return this.getUltimatePanel([[["Start",()=>{this.start()}]],[["Grant opening serve to team 1",()=>{this.grantOpeningServeTo(e)}],["Grant opening serve to team 2",()=>{this.grantOpeningServeTo(s)}]],[["Play",()=>{this.play()}]],[["Grant timeout to team 1",()=>{this.grantTimeoutTo(e)}],["Grant timeout to team 2",()=>{this.grantTimeoutTo(s)}]],[["Log serve as fault",()=>{this.logServeAsFault()}],["Log serve as ace",()=>{this.logServeAsAce()}]],[["Log point as let",()=>{this.logPointAsLet()}]],[["Log point won by team 1",()=>{this.logPointWonBy(e)}],["Log point won by team 2",()=>{this.logPointWonBy(s)}]]])}isSomePointDone=!1;play(){super.play(void 0,()=>{this.isSomePointDone=!1})}grantTimeoutTo(e){super.grantTimeoutTo(e)}logPointWonBy(e){super.logPointWonBy(e,(s,i,r)=>{this.stats.increase(o.TotalReceptionPoints,i),r?this.stats.increase(o.PointScoring,s):this.stats.increase(o.SideOut,i)},()=>{this.isLastPointWon.set(!0),this.isLastPointWon.setOpponent(!1)})}pendingPointsMaxToGoToRest=new Set;resetPendingPointsMaxToGoToRest(){this.pendingPointsMaxToGoToRest=new Set(Ae(this.scorer)?$i:Ai)}}const Qt=[{name:"Basketball",class:ci,symbol:"ðŸ€"},{name:"Tennis",class:zt,symbol:"ðŸŽ¾"},{name:"Volleyball",class:Ni,symbol:"ðŸ"}];function _e(t){const e=document.querySelector(t);return Xt(e),e}function Bi(){const t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-bs-theme",t)}function Re(t,e,s){_e(t).innerHTML=e,s?.()}function We(t){Re(t,"")}function _i(t){const e=_e("select");Qt.forEach(({name:s,symbol:i})=>{e.innerHTML+=`<option value="${s}">${i} ${s}</option>`}),e.addEventListener("change",()=>{Kt()}),t()}const Ri=t=>t===zt;function Kt(){const t=_e("select").value,e=Qt.find(({name:r})=>r===t)?.class;Xt(e),We("#scoreboard"),We("#stats"),We("#panel");let s;const i=()=>{Re("#scoreboard",s.getScoreboard()),Re("#stats",s.getStats())};if(Ri(e)){const r=new vt("Player 1"),n=new vt("Player 2");s=new e(r,n,i)}else{const r=new Tt("Team 1"),n=new Tt("Team 2");s=new e(r,n,i)}_e("#panel").append(s.getPanel())}const Fi=t=>t!=null;function Xt(t){if(!Fi(t))throw new Error(`Expected a defined value, but received: ${t}`)}Bi();Re("body",Ss,()=>{_i(()=>{Kt()})});
